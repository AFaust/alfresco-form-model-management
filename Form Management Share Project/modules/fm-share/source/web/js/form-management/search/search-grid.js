const documentTypeGrid="prop_ua_documenttype";var gridEnabled=true;var oSearchGrid=null;function getGridEnabled(aspects){var obj={};obj.fields=[];obj.headers=[];for(i in aspects){var a=aspects[i];for(z in a.properties){var f=a.properties[z];if(f.searchGrid){obj.fields.push(a.namespace+":"+f.name);obj.headers.push(f.title);}}}return obj;}function setSearchTableHeaders(aspects){var query=getURLParameter("q");var obj={};obj.fields=[];if(gridEnabled&&query.length>0&&documentTypeGrid){var q=eval("("+query+")");if(q[documentTypeGrid]!=""){$(".btn-grid-view").show();obj=getGridEnabled(aspects);$("#dropbox thead tr").append('<th class="dt-check-column"><input type="checkbox" class="dtRowSelectAll" /></th><th>Filename</th>');for(i in obj.headers){$("#dropbox thead tr").append("<th>"+obj.headers[i]+"</th>");}$("#dropbox thead tr").append("<th>Actions</th>");}}return obj.fields;}function loadDatatable(){if(!oSearchGrid){var url="/share/proxy/alfresco/slingshot/search";oSearchGrid=$("#dropbox").dataTable({"bProcessing":true,"sAjaxSource":url,"sPaginationType":"full_numbers","oLanguage":{"sSearch":""},"aaSorting":[],"fnServerData":function(sSource,aoData,fnCallback){aoData=getQueryForSearch();aoData.fields=dtFields.join(",");$.ajax({"dataType":"json","url":sSource,"data":aoData,"success":fnCallback});},"aoColumnDefs":[{bSortable:false,aTargets:[0],fnRender:function(o,v){return'<input type="checkbox" class="dtRowSelect" />';}}]});}}function printSelected(){$("body").append('<div id="printme"><table style="font-family:helvetica; font-size:12px; width:100%">'+$("table#dropbox").html()+"</table></div>");$("#printme table tbody").html("");$("#printme table th").attr("style","");$(".dtRowSelect:checked").each(function(){$(this).parents("tr").clone().appendTo("#printme table tbody");});$("#printme table tbody tr").each(function(){$(this).find("td:eq(0)").remove();$(this).find("td:last").remove();});$("#printme table thead tr").each(function(){$(this).find("th:eq(0)").remove();$(this).find("th:last").remove();});$("#printme").printThis({loadCSS:"/share/css/form-management/search/print-search-grid.css",pageTitle:"Alfresco search print results"});$("#printme").remove();}var oSelectMenuButton=null;function toggleSelectMenu(){oSelectMenuButton.set("disabled",true);if($(".dtRowSelect:checked").length>0){oSelectMenuButton.set("disabled",false);}}function setupSelectMenu(){$(".dtRowSelect").live("click",function(){toggleSelectMenu();});$(".dtRowSelectAll").live("click",function(){$(".dtRowSelect").attr("checked",false);if($(".dtRowSelectAll:checked").length>0){$(".dtRowSelect").attr("checked",true);}toggleSelectMenu();});oSelectMenuButton=new YAHOO.widget.Button("selectmenu",{type:"menu",menu:"selectmenuselect"});oSelectMenuButton.addClass("sort-button");oSelectMenuButton.set("disabled",true);var onSelectMenuClick=function(p_sType,p_aArgs){var oEvent=p_aArgs[0],oMenuItem=p_aArgs[1];if(oMenuItem){switch(oMenuItem.value){case"print":printSelected();break;case"downloadZip":var nodes=[];$(".dtRowSelect:checked").each(function(){var id=$(this).parents("tr:eq(0)").find("td:eq(1) > a").attr("href").split("/").reverse()[0];nodes.push(id);});var url="/share/proxy/alfresco/slingshot/zipContents?nodes="+nodes.join(",")+"&filename=TranscriptsDownload&noaccent=false";window.location.assign(url);break;}}};oSelectMenuButton.getMenu().subscribe("click",onSelectMenuClick);}$(function(){setupSelectMenu();});